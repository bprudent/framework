<?xml version="1.0" encoding="UTF-8"?>
<template xmlns:c = "class://CoreTag">
    <html>
        <head>
            <style type = "text/css">
            
            </style>
            <title>Preview</title>
        </head>
        <body>
            <div id = "dms-preview-pane">
                <c:php>
                <![CDATA[
                $purl = $this->href('DMS', 'preview_file', array('_no_html' => true, 'id' => $this->file->id));
                if (preg_match('|^image[/]|i', $this->file->mimeType)) {
                    print '<img src = "' . $purl . '" alt = "Preview" />';
                }
                elseif (preg_match('|video|i', $this->file->mimeType)) {
                    print '
        <object id="MediaPlayer1"
          CLASSID="CLSID:22d6f312-b0f6-11d0-94ab-0080c74c7e95"
          codebase="http://activex.microsoft.com/activex/controls/mplayer/en/nsmp2inf.cab#Version=5,1,52,701"
          standby="Loading Microsoft WindowsÂ® Media Player components..."
          type="application/x-oleobject"
          width="360"
          height="320">
        
          <param name="filename" value="' . $purl . '">
          <param name="autostart" value="true">
          <param name="showcontrols" value="true">
        
          <embed type="application/x-mplayer2"
            pluginspage="http://www.microsoft.com/Windows/MediaPlayer/"
            src="' . $purl .'"
            name="MediaPlayer"
            width=360
            height=320>
          </embed>
        </object>            
                    ';
                }
                else {
                    print '<iframe width = "100%" height = "300" src = "' . $purl . '"></iframe>';
                }
                ]]>
                </c:php>
            </div>
            <div id = "dms-preview-description">
                ${=this.file.description}
            </div>
            
            <p><a href = "javascript: window.close();">close window</a></p>
      </body>
   </html>
</template>
